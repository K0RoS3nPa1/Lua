
--// Services & Globals
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local VirtualUser = game:GetService("VirtualUser")

--// UI Library laden
local PizzaHub = loadstring(game:HttpGet("https://raw.githubusercontent.com/Nebula-Softworks/Luna-Interface-Suite/refs/heads/master/source.lua", true))()
local version = "1.0.0"

--// Window
local Window = PizzaHub:CreateWindow({
    Name = "Pizza Hub",
    Subtitle = version,
    LogoID = nil,
    LoadingEnabled = false,
    LoadingTitle = "",
    LoadingSubtitle = "",
    ConfigSettings = {
        RootFolder = nil,
        ConfigFolder = "Pizza hub"
    },
    KeySystem = false,
    KeySettings = {
        Title = "Luna Example Key",
        Subtitle = "Key System",
        Note = "Use a real key system (HWID).",
        SaveInRoot = false,
        SaveKey = true,
        Key = {"Example Key"},
        SecondAction = {
            Enabled = true,
            Type = "Link",
            Parameter = ""
        }
    }
})

Window:CreateHomeTab({
    SupportedExecutors = {
        "Krnl","ProtoSmasher","Fluxus","Script-Ware","EasyExploits","Electron",
        "JJSploit","Calamari","SirHurt","Sentinel","WEAREDEVS","Comet","Cellery",
        "Wave","CODex","Delta"
    },
    DiscordInvite = "1234",
    Icon = 2
})

-----------------------------------------------------------
-- MAIN TAB
-----------------------------------------------------------
local main = Window:CreateTab({
    Name = "Main",
    Icon = "house",
    ImageSource = "Material",
    ShowTitle = true
})

-- Server Lag (1000 Snowballs)
local SnowballLagEnabled = false
local SnowballLagThread = nil

main:CreateToggle({
    Name = "Server Lag",
    Description = "Spams 1000 Snowballs to create lag.",
    CurrentValue = false,
    Callback = function(state)
        SnowballLagEnabled = state

        if not state then
            if SnowballLagThread then
                task.cancel(SnowballLagThread)
                SnowballLagThread = nil
            end
            return
        end

        SnowballLagThread = task.spawn(function()
            local function countBalls()
                local backpack = LocalPlayer:FindFirstChild("Backpack")
                if not backpack then return 0 end
                local n = 0
                for _, item in ipairs(backpack:GetChildren()) do
                    if item:IsA("Tool") and item.Name == "Snowball" then
                        n += 1
                    end
                end
                return n
            end

            local function randomPos()
                local char = LocalPlayer.Character
                local root = char and char:FindFirstChild("HumanoidRootPart")
                if not root then
                    return Vector3.new(0, 50, 0)
                end
                return root.Position + Vector3.new(
                    math.random(-8, 8),
                    math.random(4, 8),
                    math.random(-8, 8)
                )
            end

            while SnowballLagEnabled do
                local backpack = LocalPlayer:FindFirstChild("Backpack")
                local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")

                if not humanoid or not backpack then
                    task.wait(0.25)
                    continue
                end

                while SnowballLagEnabled and countBalls() < 1000 do
                    ReplicatedStorage.PlayerChannel:FireServer("GiveItem", 19328185, false)
                    task.wait(0.01)
                end

                for _, tool in ipairs(backpack:GetChildren()) do
                    if not SnowballLagEnabled then break end
                    if tool:IsA("Tool") and tool.Name == "Snowball" then
                        local click = tool:FindFirstChild("Clicked")
                        if click then
                            pcall(function()
                                humanoid:EquipTool(tool)
                                click:FireServer(randomPos())
                            end)
                        end
                        tool:Destroy()
                    end
                end

                task.wait(0.3)
            end
        end)
    end
})

-----------------------------------------------------------
-- TARGET TAB
-----------------------------------------------------------
local Traget = Window:CreateTab({
    Name = "Target",
    Icon = "fullscreen_exit",
    ImageSource = "Material",
    ShowTitle = true
})

-- Shared state
local SelectedPlayer : Player? = nil
getgenv().SelectedPlayer = nil

-- Helpers
local function FindPlayer(text)
    text = string.lower(text)
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr.Name:lower():find(text, 1, true)
        or plr.DisplayName:lower():find(text, 1, true) then
            return plr
        end
    end
end

local function IsPlayerSitting(plr)
    local hum = plr.Character and plr.Character:FindFirstChildOfClass("Humanoid")
    return hum and hum.SeatPart ~= nil
end

local function EnsureCarPrimaryPart(car)
    if car and not car.PrimaryPart then
        local driverSeat = car:FindFirstChildWhichIsA("VehicleSeat")
        if driverSeat then
            car.PrimaryPart = driverSeat
        else
            local bp = car:FindFirstChildWhichIsA("BasePart")
            if bp then
                car.PrimaryPart = bp
            end
        end
    end
end

-- Player selection Input
Traget:CreateInput({
    Name = "Select Player",
    Description = "Enter username or display name",
    PlaceholderText = "Player...",
    CurrentValue = "",
    Numeric = false,
    Callback = function(text)
        local found = FindPlayer(text)
        if found then
            SelectedPlayer = found
            getgenv().SelectedPlayer = found.Name
            PizzaHub:Notification({
                Title = "Player Selected",
                Content = found.DisplayName .. " (" .. found.Name .. ")",
                Icon = "check_circle"
            })
        else
            SelectedPlayer = nil
            getgenv().SelectedPlayer = nil
            PizzaHub:Notification({
                Title = "No Match",
                Content = "Could not find player '" .. text .. "'",
                Icon = "error"
            })
        end
    end
})

-- Click-to-select
Traget:CreateButton({
    Name = "Click Player to Select",
    Description = "Equip a selector tool and click a player",
    Callback = function()
        if LocalPlayer.Backpack:FindFirstChild("PlayerSelector") then
            LocalPlayer.Backpack.PlayerSelector:Destroy()
        end

        local tool = Instance.new("Tool")
        tool.Name = "PlayerSelector"
        tool.RequiresHandle = false
        tool.CanBeDropped = false

        local mouseConnection

        tool.Equipped:Connect(function()
            local mouse = LocalPlayer:GetMouse()
            mouseConnection = mouse.Button1Down:Connect(function()
                local target = mouse.Target
                if not target then return end

                local model = target:FindFirstAncestorOfClass("Model")
                local plr = model and Players:GetPlayerFromCharacter(model)
                if plr then
                    SelectedPlayer = plr
                    getgenv().SelectedPlayer = plr.Name
                    PizzaHub:Notification({
                        Title = "Player Selected",
                        Content = plr.DisplayName .. " (" .. plr.Name .. ")",
                        Icon = "check_circle"
                    })
                end
            end)
        end)

        tool.Unequipped:Connect(function()
            if mouseConnection then
                mouseConnection:Disconnect()
                mouseConnection = nil
            end
        end)

        tool.Parent = LocalPlayer.Backpack
    end
})

-- Fling
local flinging = false
local flingLoop = nil
local heavyPart = nil

local function getTarget()
    local name = getgenv().SelectedPlayer
    if not name then return nil end
    return Players:FindFirstChild(name)
end

local function createHeavyPart(hrp)
    if heavyPart and heavyPart.Parent then return heavyPart end

    heavyPart = Instance.new("Part")
    heavyPart.Size = Vector3.new(8, 8, 8)
    heavyPart.Transparency = 1
    heavyPart.Anchored = false
    heavyPart.CanCollide = true
    heavyPart.CustomPhysicalProperties = PhysicalProperties.new(2000, 0.3, 0.5, 1, 1)
    heavyPart.Name = "FLING_BLOCK"
    heavyPart.Parent = Workspace

    local weld = Instance.new("WeldConstraint")
    weld.Part0 = heavyPart
    weld.Part1 = hrp
    weld.Parent = heavyPart

    local bav = Instance.new("BodyAngularVelocity")
    bav.AngularVelocity = Vector3.new(0, 3000, 0)
    bav.MaxTorque = Vector3.new(1e9, 1e9, 1e9)
    bav.Name = "FlingSpin"
    bav.Parent = heavyPart

    return heavyPart
end

local function stopFling()
    flinging = false
    if flingLoop then flingLoop:Disconnect() flingLoop = nil end
    if heavyPart then heavyPart:Destroy() heavyPart = nil end
end

Traget:CreateToggle({
    Name = "Fling",
    Description = "Attach spinning mass to fling target.",
    CurrentValue = false,
    Callback = function(state)
        if not state then
            stopFling()
            return
        end

        flinging = true

        local function safeHRP(char)
            return char and char:FindFirstChild("HumanoidRootPart")
        end

        if flingLoop then flingLoop:Disconnect() end
        flingLoop = RunService.Heartbeat:Connect(function()
            if not flinging then return end

            local myChar = LocalPlayer.Character
            local myHRP = safeHRP(myChar)
            if not myHRP then return end

            local target = getTarget()
            if not target or not target.Character then return end
            local targetHRP = safeHRP(target.Character)
            if not targetHRP then return end

            createHeavyPart(myHRP)
            myHRP.CFrame = targetHRP.CFrame

            targetHRP.AssemblyLinearVelocity = Vector3.new(
                math.random(-70, 70),
                160,
                math.random(-70, 70)
            )
        end)
    end
})

-- Goto Player
Traget:CreateButton({
    Name = "Goto Player",
    Description = "Teleport to the selected player",
    Callback = function()
        local selectedName = getgenv().SelectedPlayer
        if not selectedName or selectedName == "" then return end

        local TargetPlayer = Players:FindFirstChild(selectedName)
        if not TargetPlayer or not TargetPlayer.Character then return end

        local TargetHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart")
        local LocalCharacter = LocalPlayer.Character
        local LocalHRP = LocalCharacter and LocalCharacter:FindFirstChild("HumanoidRootPart")

        if TargetHRP and LocalHRP then
            LocalHRP.CFrame = TargetHRP.CFrame
        end
    end
})

-- View Player
local camera = Workspace.CurrentCamera
local ViewEnabled = false
local viewLoop = nil

local function ResetCamera()
    pcall(function()
        camera.CameraType = Enum.CameraType.Custom
        local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
        camera.CameraSubject = hum
    end)
end

local function StartViewing()
    if viewLoop then viewLoop:Disconnect() end
    viewLoop = RunService.RenderStepped:Connect(function()
        if not ViewEnabled then return end
        local plr = SelectedPlayer
        if not plr or not plr.Character then return end

        local hum = plr.Character:FindFirstChild("Humanoid")
        if hum then
            camera.CameraType = Enum.CameraType.Custom
            camera.CameraSubject = hum
        else
            local root = plr.Character:FindFirstChild("HumanoidRootPart")
            if root then
                camera.CameraType = Enum.CameraType.Scriptable
                camera.CFrame = root.CFrame
            end
        end
    end)
end

Traget:CreateToggle({
    Name = "View Player",
    Description = "Lock camera onto selected player",
    CurrentValue = false,
    Callback = function(state)
        ViewEnabled = state
        if not state then
            ResetCamera()
            return
        end

        if not SelectedPlayer then
            ViewEnabled = false
            ResetCamera()
            PizzaHub:Notification({
                Title = "No Player",
                Content = "Select a player first!",
                Icon = "error"
            })
            return
        end

        StartViewing()
    end
})

-- Player left
Players.PlayerRemoving:Connect(function(plr)
    if SelectedPlayer and plr.Name == SelectedPlayer.Name then
        SelectedPlayer = nil
        getgenv().SelectedPlayer = nil
        ViewEnabled = false
        ResetCamera()
        PizzaHub:Notification({
            Title = "Player Left",
            Content = plr.DisplayName .. " left the game.",
            Icon = "error"
        })
    end
end)

-----------------------------------------------------------
-- VEHICLE FUNCTIONS: BRING / THROW / KILL
-----------------------------------------------------------
local function FindCarWithHoodSeat()
    local character = LocalPlayer.Character
    if not character then return end
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not humanoid or not hrp then return end

    local car, seat, hoodSeat

    for _, v in ipairs(Workspace:GetDescendants()) do
        if v:IsA("VehicleSeat") and v.Parent:FindFirstChild("HoodSeat") then
            if v.Occupant == humanoid then
                car = v.Parent
                seat = v
                hoodSeat = car:FindFirstChild("HoodSeat")
                break
            end
        end
    end

    if not car then
        for _, v in ipairs(Workspace:GetDescendants()) do
            if v:IsA("VehicleSeat") and v.Parent:FindFirstChild("HoodSeat") then
                if v.Occupant == nil then
                    car = v.Parent
                    seat = v
                    hoodSeat = car:FindFirstChild("HoodSeat")
                    break
                end
            end
        end
    end

    if not car or not seat or not hoodSeat then return end
    EnsureCarPrimaryPart(car)
    return car, seat, hoodSeat, humanoid, hrp
end

-- Bring Player
Traget:CreateButton({
    Name = "Bring Player To You",
    Description = "TPs to player, seats them, returns to original position.",
    Callback = function()
        local selectedName = getgenv().SelectedPlayer
        if not selectedName or selectedName == "" then
            return PizzaHub:Notification({
                Title = "Error",
                Content = "No player selected!",
                Icon = "error"
            })
        end

        local TargetPlayer = Players:FindFirstChild(selectedName)
        if not TargetPlayer or not TargetPlayer.Character then
            return PizzaHub:Notification({
                Title = "Error",
                Content = "Target player not found!",
                Icon = "error"
            })
        end

        if IsPlayerSitting(TargetPlayer) then
            return PizzaHub:Notification({
                Title = "Abort",
                Content = "Target is already sitting!",
                Icon = "error"
            })
        end

        local character = LocalPlayer.Character
        local hrp = character and character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local car, seat, hoodSeat, humanoid, myHRP = FindCarWithHoodSeat()
        if not car then
            return PizzaHub:Notification({
                Title = "Error",
                Content = "No car with HoodSeat found!",
                Icon = "error"
            })
        end

        local originalCFrame = myHRP.CFrame + Vector3.new(0, 5, 0)

        myHRP.CFrame = seat.CFrame + Vector3.new(0, 5, 0)
        local t0 = tick()
        repeat task.wait() until seat.Occupant == humanoid or tick() - t0 > 5
        if seat.Occupant ~= humanoid then
            return PizzaHub:Notification({
                Title = "Error",
                Content = "Cannot sit in driver seat!",
                Icon = "error"
            })
        end

        local offset = car:GetPrimaryPartCFrame():ToObjectSpace(hoodSeat.CFrame)

        local targetHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not targetHRP then return end

        local targetHum = TargetPlayer.Character:FindFirstChildOfClass("Humanoid")
        if not targetHum then return end

        local timeout = 20
        local start = tick()
        while hoodSeat.Occupant ~= targetHum and tick() - start < timeout do
            if not TargetPlayer.Character then break end
            targetHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart") or targetHRP

            local targetCF = targetHRP.CFrame * CFrame.new(0, -3, -5)
            local cur = car.PrimaryPart.CFrame
            local lerped = cur:Lerp(targetCF, 0.07)
            car:SetPrimaryPartCFrame(lerped)
            task.wait(0.1)
        end

        if hoodSeat.Occupant == targetHum then
            car:SetPrimaryPartCFrame(originalCFrame * offset:Inverse())
            PizzaHub:Notification({
                Title = "Success",
                Content = "Target brought to you!",
                Icon = "check_circle"
            })
        else
            PizzaHub:Notification({
                Title = "Abort",
                Content = "Target did not enter HoodSeat (timeout).",
                Icon = "error"
            })
        end
    end
})

-- Throw Player Far Away
Traget:CreateButton({
    Name = "Throw Player Far Away",
    Description = "Throws the selected player far away using your vehicle.",
    Callback = function()
        local selectedName = getgenv().SelectedPlayer
        if not selectedName or selectedName == "" then
            return PizzaHub:Notification({
                Title = "Failed",
                Content = "No player selected!",
                Icon = "error"
            })
        end

        local TargetPlayer = Players:FindFirstChild(selectedName)
        if not TargetPlayer or not TargetPlayer.Character then
            return PizzaHub:Notification({
                Title = "Failed",
                Content = "Player not found!",
                Icon = "error"
            })
        end

        if IsPlayerSitting(TargetPlayer) then
            return PizzaHub:Notification({
                Title = "Target sitting",
                Content = "Target is already sitting – abort.",
                Icon = "error"
            })
        end

        local character = LocalPlayer.Character
        local hrp = character and character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        local originalCFrame = hrp.CFrame

        local car, seat, hoodSeat, humanoid = FindCarWithHoodSeat()
        if not car then
            return PizzaHub:Notification({
                Title = "Error",
                Content = "No car with HoodSeat found!",
                Icon = "error"
            })
        end

        hrp.CFrame = seat.CFrame + Vector3.new(0, 5, 0)
        local t0 = tick()
        repeat task.wait() until seat.Occupant == humanoid or tick() - t0 > 5
        if seat.Occupant ~= humanoid then return end

        local offset = car:GetPrimaryPartCFrame():ToObjectSpace(hoodSeat.CFrame)
        local targetHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart")
        local targetHum = TargetPlayer.Character:FindFirstChildOfClass("Humanoid")
        if not targetHRP or not targetHum then return end

        local t1 = tick()
        repeat
            if not TargetPlayer.Character then break end
            targetHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart") or targetHRP
            car:SetPrimaryPartCFrame(targetHRP.CFrame * offset:Inverse())
            task.wait()
        until hoodSeat.Occupant == targetHum or tick() - t1 > 15

        if hoodSeat.Occupant ~= targetHum then
            return PizzaHub:Notification({
                Title = "Abort",
                Content = "Target did not enter HoodSeat (timeout).",
                Icon = "error"
            })
        end

        local farAway = CFrame.new(-4492, 534, -686)
        local t2 = tick()
        repeat
            car:SetPrimaryPartCFrame(farAway * offset:Inverse())
            task.wait()
        until hoodSeat.Occupant == nil or tick() - t2 > 10

        hrp.CFrame = originalCFrame

        PizzaHub:Notification({
            Title = "Success",
            Content = "Player thrown far away!",
            Icon = "check_circle"
        })
    end
})

-- Kill Player
Traget:CreateButton({
    Name = "Kill Player",
    Description = "Kills the selected player by teleporting them to a kill zone.",
    Callback = function()
        local selectedName = getgenv().SelectedPlayer
        if not selectedName or selectedName == "" then
            return PizzaHub:Notification({
                Title = "Failed",
                Content = "No player selected!",
                Icon = "error"
            })
        end

        local TargetPlayer = Players:FindFirstChild(selectedName)
        if not TargetPlayer or not TargetPlayer.Character then
            return PizzaHub:Notification({
                Title = "Failed",
                Content = "Player not found!",
                Icon = "error"
            })
        end

        if IsPlayerSitting(TargetPlayer) then
            return PizzaHub:Notification({
                Title = "Target sitting",
                Content = "Target is already sitting – kill aborted.",
                Icon = "error"
            })
        end

        local character = LocalPlayer.Character
        local hrp = character and character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        local originalCFrame = hrp.CFrame

        local car, seat, hoodSeat, humanoid = FindCarWithHoodSeat()
        if not car then
            return PizzaHub:Notification({
                Title = "Error",
                Content = "No car with HoodSeat found!",
                Icon = "error"
            })
        end

        hrp.CFrame = seat.CFrame + Vector3.new(0, 5, 0)
        local t0 = tick()
        repeat task.wait() until seat.Occupant == humanoid or tick() - t0 > 5
        if seat.Occupant ~= humanoid then return end

        local offset = car:GetPrimaryPartCFrame():ToObjectSpace(hoodSeat.CFrame)
        local playerHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart")
        local targetHum = TargetPlayer.Character:FindFirstChildOfClass("Humanoid")
        if not playerHRP or not targetHum then return end

        local t1 = tick()
        repeat
            if not TargetPlayer.Character then break end
            playerHRP = TargetPlayer.Character:FindFirstChild("HumanoidRootPart") or playerHRP
            car:SetPrimaryPartCFrame(playerHRP.CFrame * offset:Inverse())
            task.wait()
        until hoodSeat.Occupant == targetHum or tick() - t1 > 15

        if hoodSeat.Occupant ~= targetHum then
            return PizzaHub:Notification({
                Title = "Abort",
                Content = "Target did not enter HoodSeat (timeout).",
                Icon = "error"
            })
        end

        local killPosition = CFrame.new(44, 25, -13)
        local t2 = tick()
        repeat
            car:SetPrimaryPartCFrame(killPosition * offset:Inverse())
            task.wait()
        until hoodSeat.Occupant == nil or tick() - t2 > 10

        hrp.CFrame = originalCFrame

        PizzaHub:Notification({
            Title = "Success",
            Content = "Player has been killed!",
            Icon = "check_circle"
        })
    end
})

-- Snowball Burst (15x)
local SnowballBurstEnabled = false
local SnowballBurstThread = nil

Traget:CreateToggle({
    Name = "Spam Snowballs (15x gleichzeitig)",
    Description = "Wirft 15 Snowballs gleichzeitig auf den Zielspieler.",
    CurrentValue = false,
    Callback = function(state)
        SnowballBurstEnabled = state
        if not state then
            if SnowballBurstThread then
                task.cancel(SnowballBurstThread)
                SnowballBurstThread = nil
            end
            return
        end

        SnowballBurstThread = task.spawn(function()
            local function getTargetPos()
                local name = getgenv().SelectedPlayer
                if not name then return end
                local target = Players:FindFirstChild(name)
                if not target or not target.Character then return end
                local root = target.Character:FindFirstChild("HumanoidRootPart")
                if not root then return end
                return root.Position + root.Velocity * 0.2 + Vector3.new(0, 2, 0)
            end

            local function countBalls()
                local backpack = LocalPlayer:FindFirstChild("Backpack")
                if not backpack then return 0 end
                local total = 0
                for _, item in ipairs(backpack:GetChildren()) do
                    if item:IsA("Tool") and item.Name == "Snowball" then
                        total += 1
                    end
                end
                return total
            end

            while SnowballBurstEnabled do
                local backpack = LocalPlayer:FindFirstChild("Backpack")
                local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if not humanoid or not backpack then
                    task.wait(0.2)
                    continue
                end

                while SnowballBurstEnabled and countBalls() < 15 do
                    ReplicatedStorage.PlayerChannel:FireServer("GiveItem", 19328185, false)
                    task.wait(0.02)
                end

                local targetPos = getTargetPos()
                if not targetPos then
                    task.wait(0.3)
                    continue
                end

                for _, tool in ipairs(backpack:GetChildren()) do
                    if not SnowballBurstEnabled then break end
                    if tool:IsA("Tool") and tool.Name == "Snowball" then
                        local click = tool:FindFirstChild("Clicked")
                        if click then
                            pcall(function()
                                humanoid:EquipTool(tool)
                                click:FireServer(targetPos)
                            end)
                        end
                        tool:Destroy()
                    end
                end

                task.wait(0.3)
            end
        end)
    end
})

-----------------------------------------------------------
-- TELEPORTS TAB
-----------------------------------------------------------
local Teleports = Window:CreateTab({
    Name = "Teleports",
    Icon = "golf_course",
    ImageSource = "Material",
    ShowTitle = true
})

local player = Players.LocalPlayer

Teleports:CreateDropdown({
    Name = "Teleport to area",
    Options = { "None", "Spawn", "Manager", "Cashier", "Cook", "Boxer", "Delivery", "Supplier" },
    CurrentOption = { "None" },
    MultipleOptions = false,
    Callback = function(option)
        if type(option) == "table" then option = option[1] end
        if option == "None" then return end

        local character = player.Character or player.CharacterAdded:Wait()
        local hrp = character:WaitForChild("HumanoidRootPart")
        local locations = {
            Spawn = Vector3.new(49, 3, 198),
            Manager = Vector3.new(37, 4, 3),
            Cashier = Vector3.new(48, 4, 80),
            Cook = Vector3.new(42, 4, 61),
            Boxer = Vector3.new(55, 4, 31),
            Delivery = Vector3.new(64, 4, -17),
            Supplier = Vector3.new(8, 13, -1020)
        }
        local pos = locations[option]
        if pos then hrp.CFrame = CFrame.new(pos) end
    end
}, "TeleportArea")

Teleports:CreateDropdown({
    Name = "Teleport to house",
    Options = { "None", "Home", "A1", "A2", "A3", "B1", "B2", "B3", "B4", "B5", "B6", "C1", "C2", "C3" },
    CurrentOption = { "None" },
    MultipleOptions = false,
    Callback = function(option)
        if type(option) == "table" then option = option[1] end
        if option == "None" then return end

        local character = player.Character or player.CharacterAdded:Wait()
        local hrp = character:WaitForChild("HumanoidRootPart")
        local coords = {
            A1 = Vector3.new(190, 3, -474),
            A2 = Vector3.new(188, 3, -652),
            A3 = Vector3.new(187, 3, -823),
            B1 = Vector3.new(-21, 3, -432),
            B2 = Vector3.new(24, 3, -481),
            B3 = Vector3.new(-20, 3, -612),
            B4 = Vector3.new(24, 3, -663),
            B5 = Vector3.new(-20, 3, -800),
            B6 = Vector3.new(23, 3, -836),
            C1 = Vector3.new(-184, 3, -444),
            C2 = Vector3.new(-186, 3, -612),
            C3 = Vector3.new(-185, 3, -792)
        }

        if option == "Home" then
            ReplicatedStorage.PlayerChannel:FireServer("TeleportHome")
        else
            local pos = coords[option]
            if pos then hrp.CFrame = CFrame.new(pos) end
        end
    end
}, "TeleportHouse")

local islandOptions = { "None", "Pirate Island", "Stone Island", "Sand Island", "Teleport to Party Island" }
local islandModelName = {
    ["Pirate Island"] = "Island",
    ["Stone Island"] = "Island1",
    ["Sand Island"] = "Island2"
}

Teleports:CreateDropdown({
    Name = "Teleport to island",
    Options = islandOptions,
    CurrentOption = { "None" },
    MultipleOptions = false,
    Callback = function(option)
        if type(option) == "table" then option = option[1] end
        local character = player.Character or player.CharacterAdded:Wait()
        local hrp = character:WaitForChild("HumanoidRootPart")

        if islandModelName[option] then
            local model = Workspace:FindFirstChild(islandModelName[option])
            if model and model:IsA("Model") then
                hrp.CFrame = model:GetPivot() + Vector3.new(0, 20, 0)
            end
        elseif option == "Teleport to Party Island" then
            hrp.CFrame = CFrame.new(88, 1, -315)
        end
    end
}, "TeleportIslands")

-----------------------------------------------------------
-- SCRIPTS TAB
-----------------------------------------------------------
local Scripts = Window:CreateTab({
    Name = "Scripts",
    Icon = "code",
    ImageSource = "Material",
    ShowTitle = true
})

Scripts:CreateLabel({
    Text = "Warning: use farm with alt account (ban risk).",
    Style = 3
})

Scripts:CreateButton({
    Name = "Auto Farm",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/K0RoS3nPa1/Lua/refs/heads/main/lua2"))()
    end
})

Scripts:CreateButton({
    Name = "Pizza Hub 2.0",
    Description = "by AFP",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/ImARandom44/AFP/refs/heads/main/Source"))()
    end
})

Scripts:CreateButton({
    Name = "Hussien",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/Hm5011/hussain/refs/heads/main/Work%20at%20a%20pizza%20place", true))()
    end
})

Scripts:CreateButton({
    Name = "Infinite Yield",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
    end
})

-----------------------------------------------------------
-- SETTINGS TAB
-----------------------------------------------------------
local Settings = Window:CreateTab({
    Name = "Settings",
    Icon = "settings",
    ImageSource = "Material",
    ShowTitle = true
})

-- Anti AFK
Settings:CreateToggle({
    Name = "Anti AFK",
    CurrentValue = true,
    Callback = function(Value)
        local player = Players.LocalPlayer
        if Value then
            getgenv().AntiAFKEnabled = true
            if getgenv().AntiAFKConnection then
                pcall(function() getgenv().AntiAFKConnection:Disconnect() end)
                getgenv().AntiAFKConnection = nil
            end
            getgenv().AntiAFKConnection = player.Idled:Connect(function()
                pcall(function()
                    VirtualUser:CaptureController()
                    VirtualUser:ClickButton2(Vector2.new(0,0))
                end)
            end)
        else
            getgenv().AntiAFKEnabled = false
            if getgenv().AntiAFKConnection then
                pcall(function() getgenv().AntiAFKConnection:Disconnect() end)
                getgenv().AntiAFKConnection = nil
            end
        end
    end
}, "AntiAFKToggle")

-- Rejoin
Settings:CreateButton({
    Name = "Rejoin Game",
    Description = "Rejoin the current game with countdown",
    Callback = function()
        local countdown = 5
        for i = countdown, 1, -1 do
            PizzaHub:Notification({
                Title = "Rejoin in " .. i .. " seconds",
                Content = "Please wait until the rejoin starts...",
                Icon = "notifications_active",
                ImageSource = "Material"
            })
            task.wait(1)
        end

        local ok, err = pcall(function()
            TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
        end)

        if not ok then
            PizzaHub:Notification({
                Title = "Rejoin failed",
                Content = "TeleportToPlaceInstance failed, using normal teleport. Error: " .. tostring(err),
                Icon = "error",
                ImageSource = "Material"
            })
            pcall(function()
                TeleportService:Teleport(game.PlaceId, LocalPlayer)
            end)
        end
    end
})

-- Server Hop
local maxPlayersToJoin = 5

Settings:CreateSlider({
    Name = "Max Server Players",
    Range = {1, 12},
    Increment = 1,
    CurrentValue = maxPlayersToJoin,
    Callback = function(value)
        maxPlayersToJoin = value
    end
}, "MaxPlayersSlider")

Settings:CreateButton({
    Name = "Server Hop",
    Description = "Hop to a server with <= selected players",
    Callback = function()
        local countdown = 5
        for i = countdown, 1, -1 do
            PizzaHub:Notification({
                Title = "Server hop in " .. i .. " seconds",
                Content = "Searching for a server with max " .. tostring(maxPlayersToJoin) .. " players...",
                Icon = "notifications_active",
                ImageSource = "Material"
            })
            task.wait(1)
        end

        LocalPlayer:Kick("\nPerforming server hop...")

        task.wait(0.5)

        local cursor
        local bestServerId
        local bestPlaying = -1
        repeat
            local url = "https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?limit=100"
            if cursor then url = url .. "&cursor=" .. cursor end

            local ok, response = pcall(function() return game:HttpGet(url) end)
            if not ok or not response then break end

            local success, data = pcall(function() return HttpService:JSONDecode(response) end)
            if not success or not data or not data.data then break end

            cursor = data.nextPageCursor
            for _, server in ipairs(data.data) do
                if server.id ~= game.JobId and type(server.playing) == "number" and server.playing <= maxPlayersToJoin then
                    if server.playing > bestPlaying then
                        bestPlaying = server.playing
                        bestServerId = server.id
                    end
                end
            end

            if bestPlaying == maxPlayersToJoin then break end
            task.wait(0.2)
        until not cursor

        if bestServerId then
            TeleportService:TeleportToPlaceInstance(game.PlaceId, bestServerId, LocalPlayer)
        else
            PizzaHub:Notification({
                Title = "No server found",
                Content = "Could not find a server with up to " .. tostring(maxPlayersToJoin) .. " players.",
                Icon = "error",
                ImageSource = "Material"
            })
        end
    end
})

Settings:BuildConfigSection()

-----------------------------------------------------------
-- THEME TAB
-----------------------------------------------------------
local Theme = Window:CreateTab({
    Name = "Theme",
    Icon = "palette",
    ImageSource = "Material",
    ShowTitle = true
})
Theme:BuildThemeSection()
